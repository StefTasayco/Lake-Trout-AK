---
title: "Lake Clark"
subtitle: "visualizing temperature data"
author: "Stef Tasayco"
date: "`r format(Sys.Date(), '%d %b %Y')`"
number-sections: true
number-offset: 0
toc: true
toc-depth: 2
fig-width: 6
fig-height: 4
df-print: kable
embed-resources: true
format: 
  html: 
    highlight-style: dracula
    code-tools: true
    code-fold: show
    code-summary: "Show the code"
    code-line-numbers: true
    code-link: true # only works if code-line-numbers: false
    toc-float: true
  docx: 
    toc-title: "Table of contents"
    fig-dpi: 600
    execute:
      echo: false
knitr: 
  opts_chunk: 
    fig.path: "plots/"
    fig.keep: "all"
    dev: ['png', 'pdf']
    dev.args: 
      pdf: 
        encoding: 'WinAnsi'
        useDingbats: false
#bibliography: references.bib # if using references, need a .bib file
#csl: gpl.csl # find your preferred citation style at https://www.zotero.org/styles
#css: style.css # optional html styling
crossref:
  fig-prefix: Fig.
  tbl-prefix: Table
  ref-hyperlink: true
editor: source
---

# Setup

Using `r R.version.string` , @R, and ggplot2 version `r packageVersion("ggplot2")` from the tidyverse [@tidyverse].

```{r}
#| label: setup
#| message: false

# load packages
library(ggplot2)
library(dplyr)
library(writexl)
library(janitor)
library(readxl)

# ensure here is available and set render root directory
knitr::opts_knit$set(
  root.dir = "C:/Users/stta6032/OneDrive - UCB-O365/Documents/GitHub/Lake-Trout-AK"
)
dir.create("plots", showWarnings = FALSE, recursive = TRUE)
knitr::opts_chunk$set(fig.path = "plots/")
```

# Data

```{r}
# load data
surface_temp <- read_excel("data/LAC_2020_surface.xlsx")
depth_bins <- read_excel("data/LAC_2020_depth_bins.xlsx")
```

# Plots {#sec-plots}

@fig-example in section @sec-plots is a work of art.

## Scenario 1
The purpose of scenario 1 is to investigate when 9 C becomes available at each lake (e.g. days 196-215) and use 9 C for all of those days. For all other days, use surface temperature data. This approach is used by Yu-Chun Kao et. al.(2014).

@fig-surface in @sec-plots shows only surface temperatures for Lake Clark

```{r}
#| label: fig-surface
#| fig-cap: This plot shows all the avialble surface water temperature data for 2020 in Lake Clark. The year 2020 is used because that is the year that lake trout data was collected. The freeze-up date can be seen at Jan 23rd and the break-up date on April 25th. The black line shows the 9 C cutoff. After mid-April (summer months), it is expected that lake trout will seek to stay around 9 C.
#| fig-cap-location: bottom

surface_temp |>
  ggplot(aes(x = date)) +
  geom_point(aes(y = t_surface, color = "Matt")) +
  geom_point(aes(y = temp, color = "Krista")) +
  #creates black line at 9C which is lake trout preferred temperature
  geom_hline(
    data = ~.x,
    mapping = aes(yintercept = 9)
  ) +
  labs(
    title = "Lake Clark – 2020 Surface Water Temperature",
    x = "Date",
    y = "Temperature (°C)",
    color = "Dataset"
  ) +
  theme_minimal()
```



```{r}
#| label: fig-depthbins
#| fig-cap: This plot only encapsulates 3 dates in the summer months during which temperatures were taken at different dpeth bins. Again, the black line shows 9 C. The goal was to visualize how far down the sun warms the water to 9 C during the summer. With this information, we can suspect that lake trout will travel down to 20 m below the surface to achieve their preferred temperature.
#| fig-cap-location: bottom

LAC_2020_depth_bins |>
  mutate(depth_bin = factor(depth_bin, levels = c(5, 10, 15, 20, 25, 30))) |>
  ggplot(aes(x = date, y = mean_temp, color = depth_bin)) +
  geom_point() +
  geom_hline(
    data = ~.x,
    mapping = aes(yintercept = 9)
  ) +
  labs(
    x = "Date",
    y = "Mean temperature (°C)",
    color = "Depth (m)",
    title = "Lake Clark - 2020 mean daily temperature by depth bin"
  ) +
  theme_minimal()
```

### Heading 3

# Tables

My @tbl-example is even more amazing.

```{r}
#| label: tbl-example
#| tbl-cap: This is my happy table, even has a beautiful equation $x^2 - \alpha$
#| tbl-cap-location: top
mpg |> head()
```

# References

::: {#refs}
:::
